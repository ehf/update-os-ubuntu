(base) [22:40]:[$USER@W-GPVW493|CentOS-7:update-os-ubuntu]$ ansible -T 10 -i /var/tmp/inventory.txt nodes -m "command" -a "uptime" -u $USER --become --limit=nodes
34.83.126.81 | CHANGED | rc=0 >>
 06:40:32 up 3 min,  1 user,  load average: 0.02, 0.05, 0.02
34.105.64.15 | CHANGED | rc=0 >>
 06:40:32 up 4 min,  1 user,  load average: 0.02, 0.08, 0.04
34.82.184.45 | CHANGED | rc=0 >>
 06:40:32 up 22 min,  1 user,  load average: 0.00, 0.00, 0.00
35.203.155.182 | CHANGED | rc=0 >>
 06:40:32 up 22 min,  1 user,  load average: 0.00, 0.00, 0.00
(base) [22:40]:[$USER@W-GPVW493|CentOS-7:update-os-ubuntu]$ ansible-playbook -i /var/tmp/inventory.txt update.yml -u $USER --become --limit=nodes

PLAY [nodes] **************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************
ok: [34.82.184.45]

TASK [assert host is running ubuntu version we're updating] ***************************************************************************************************************
ok: [34.82.184.45] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [output os version before update] ************************************************************************************************************************************
ok: [34.82.184.45] => {
    "msg": "Ubuntu 16.04"
}

TASK [output kernel version before update] ********************************************************************************************************************************
ok: [34.82.184.45] => {
    "msg": "kernel: 4.15.0-1092-gcp kernel_version: #105~16.04.1-Ubuntu SMP Wed Jan 20 09:27:40 UTC 2021"
}

TASK [if needed, install ipmitool] ****************************************************************************************************************************************
ok: [34.82.184.45]

TASK [collect host console info] ******************************************************************************************************************************************
changed: [34.82.184.45]

TASK [output host console info] *******************************************************************************************************************************************
ok: [34.82.184.45] => {
    "console_info.stdout_lines": []
}

TASK [update os] **********************************************************************************************************************************************************
ok: [34.82.184.45]

TASK [check if reboot is needed] ******************************************************************************************************************************************
ok: [34.82.184.45]

TASK [reboot host if required] ********************************************************************************************************************************************
skipping: [34.82.184.45]

TASK [check for host to come back online] *********************************************************************************************************************************
ok: [34.82.184.45]

TASK [check uname after update] *******************************************************************************************************************************************
changed: [34.82.184.45]

TASK [check lsbrelease after update] **************************************************************************************************************************************
changed: [34.82.184.45]

TASK [check uptime after update] ******************************************************************************************************************************************
changed: [34.82.184.45]

TASK [output various check vars] ******************************************************************************************************************************************
ok: [34.82.184.45] => (item=check_uname_after_update) => {
    "ansible_loop_var": "item",
    "check_uname_after_update.stdout_lines": [
        "Linux ubu-1604-1 4.15.0-1092-gcp #105~16.04.1-Ubuntu SMP Wed Jan 20 09:27:40 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux"
    ],
    "item": "check_uname_after_update"
}
ok: [34.82.184.45] => (item=check_uptime_after_update) => {
    "ansible_loop_var": "item",
    "check_uptime_after_update.stdout_lines": [
        " 06:42:07 up 23 min,  1 user,  load average: 0.11, 0.04, 0.01"
    ],
    "item": "check_uptime_after_update"
}
ok: [34.82.184.45] => (item=check_lsbrelease) => {
    "ansible_loop_var": "item",
    "check_lsbrelease.stdout_lines": [
        "Distributor ID:\tUbuntu",
        "Description:\tUbuntu 16.04.7 LTS",
        "Release:\t16.04",
        "Codename:\txenial"
    ],
    "item": "check_lsbrelease"
}

PLAY [nodes] **************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************
ok: [35.203.155.182]

TASK [assert host is running ubuntu version we're updating] ***************************************************************************************************************
ok: [35.203.155.182] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [output os version before update] ************************************************************************************************************************************
ok: [35.203.155.182] => {
    "msg": "Ubuntu 16.04"
}

TASK [output kernel version before update] ********************************************************************************************************************************
ok: [35.203.155.182] => {
    "msg": "kernel: 4.15.0-1092-gcp kernel_version: #105~16.04.1-Ubuntu SMP Wed Jan 20 09:27:40 UTC 2021"
}

TASK [if needed, install ipmitool] ****************************************************************************************************************************************
changed: [35.203.155.182]

TASK [collect host console info] ******************************************************************************************************************************************
changed: [35.203.155.182]

TASK [output host console info] *******************************************************************************************************************************************
ok: [35.203.155.182] => {
    "console_info.stdout_lines": []
}

TASK [update os] **********************************************************************************************************************************************************
changed: [35.203.155.182]

TASK [check if reboot is needed] ******************************************************************************************************************************************
ok: [35.203.155.182]

TASK [reboot host if required] ********************************************************************************************************************************************
changed: [35.203.155.182]

TASK [check for host to come back online] *********************************************************************************************************************************
ok: [35.203.155.182]

TASK [check uname after update] *******************************************************************************************************************************************
changed: [35.203.155.182]

TASK [check lsbrelease after update] **************************************************************************************************************************************
changed: [35.203.155.182]

TASK [check uptime after update] ******************************************************************************************************************************************
changed: [35.203.155.182]

TASK [output various check vars] ******************************************************************************************************************************************
ok: [35.203.155.182] => (item=check_uname_after_update) => {
    "ansible_loop_var": "item",
    "check_uname_after_update.stdout_lines": [
        "Linux ubu-1604-2 4.15.0-1092-gcp #105~16.04.1-Ubuntu SMP Wed Jan 20 09:27:40 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux"
    ],
    "item": "check_uname_after_update"
}
ok: [35.203.155.182] => (item=check_uptime_after_update) => {
    "ansible_loop_var": "item",
    "check_uptime_after_update.stdout_lines": [
        " 06:43:54 up 1 min,  1 user,  load average: 0.19, 0.04, 0.01"
    ],
    "item": "check_uptime_after_update"
}
ok: [35.203.155.182] => (item=check_lsbrelease) => {
    "ansible_loop_var": "item",
    "check_lsbrelease.stdout_lines": [
        "Distributor ID:\tUbuntu",
        "Description:\tUbuntu 16.04.7 LTS",
        "Release:\t16.04",
        "Codename:\txenial"
    ],
    "item": "check_lsbrelease"
}

RUNNING HANDLER [pause in between] ****************************************************************************************************************************************
Pausing for 20 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [35.203.155.182]

PLAY [nodes] **************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************
ok: [34.105.64.15]

TASK [assert host is running ubuntu version we're updating] ***************************************************************************************************************
ok: [34.105.64.15] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [output os version before update] ************************************************************************************************************************************
ok: [34.105.64.15] => {
    "msg": "Ubuntu 18.04"
}

TASK [output kernel version before update] ********************************************************************************************************************************
ok: [34.105.64.15] => {
    "msg": "kernel: 5.4.0-1036-gcp kernel_version: #39~18.04.1-Ubuntu SMP Sun Jan 17 11:08:21 UTC 2021"
}

TASK [if needed, install ipmitool] ****************************************************************************************************************************************
changed: [34.105.64.15]

TASK [collect host console info] ******************************************************************************************************************************************
changed: [34.105.64.15]

TASK [output host console info] *******************************************************************************************************************************************
ok: [34.105.64.15] => {
    "console_info.stdout_lines": []
}

TASK [update os] **********************************************************************************************************************************************************
ok: [34.105.64.15]

TASK [check if reboot is needed] ******************************************************************************************************************************************
ok: [34.105.64.15]

TASK [reboot host if required] ********************************************************************************************************************************************
skipping: [34.105.64.15]

TASK [check for host to come back online] *********************************************************************************************************************************
ok: [34.105.64.15]

TASK [check uname after update] *******************************************************************************************************************************************
changed: [34.105.64.15]

TASK [check lsbrelease after update] **************************************************************************************************************************************
changed: [34.105.64.15]

TASK [check uptime after update] ******************************************************************************************************************************************
changed: [34.105.64.15]

TASK [output various check vars] ******************************************************************************************************************************************
ok: [34.105.64.15] => (item=check_uname_after_update) => {
    "ansible_loop_var": "item",
    "check_uname_after_update.stdout_lines": [
        "Linux ubu-1804-1 5.4.0-1036-gcp #39~18.04.1-Ubuntu SMP Sun Jan 17 11:08:21 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux"
    ],
    "item": "check_uname_after_update"
}
ok: [34.105.64.15] => (item=check_uptime_after_update) => {
    "ansible_loop_var": "item",
    "check_uptime_after_update.stdout_lines": [
        " 06:45:22 up 9 min,  1 user,  load average: 0.12, 0.08, 0.04"
    ],
    "item": "check_uptime_after_update"
}
ok: [34.105.64.15] => (item=check_lsbrelease) => {
    "ansible_loop_var": "item",
    "check_lsbrelease.stdout_lines": [
        "Distributor ID:\tUbuntu",
        "Description:\tUbuntu 18.04.5 LTS",
        "Release:\t18.04",
        "Codename:\tbionic"
    ],
    "item": "check_lsbrelease"
}

PLAY [nodes] **************************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************
ok: [34.83.126.81]

TASK [assert host is running ubuntu version we're updating] ***************************************************************************************************************
ok: [34.83.126.81] => {
    "changed": false,
    "msg": "All assertions passed"
}

TASK [output os version before update] ************************************************************************************************************************************
ok: [34.83.126.81] => {
    "msg": "Ubuntu 18.04"
}

TASK [output kernel version before update] ********************************************************************************************************************************
ok: [34.83.126.81] => {
    "msg": "kernel: 5.4.0-1036-gcp kernel_version: #39~18.04.1-Ubuntu SMP Sun Jan 17 11:08:21 UTC 2021"
}

TASK [if needed, install ipmitool] ****************************************************************************************************************************************
changed: [34.83.126.81]

TASK [collect host console info] ******************************************************************************************************************************************
changed: [34.83.126.81]

TASK [output host console info] *******************************************************************************************************************************************
ok: [34.83.126.81] => {
    "console_info.stdout_lines": []
}

TASK [update os] **********************************************************************************************************************************************************
changed: [34.83.126.81]

TASK [check if reboot is needed] ******************************************************************************************************************************************
ok: [34.83.126.81]

TASK [reboot host if required] ********************************************************************************************************************************************
[WARNING]: Failed to reset connection:Control socket connect(/home/$USER/.ansible/cp/680a613302): No such file or directory
changed: [34.83.126.81]

TASK [check for host to come back online] *********************************************************************************************************************************
ok: [34.83.126.81]

TASK [check uname after update] *******************************************************************************************************************************************
changed: [34.83.126.81]

TASK [check lsbrelease after update] **************************************************************************************************************************************
changed: [34.83.126.81]

TASK [check uptime after update] ******************************************************************************************************************************************
changed: [34.83.126.81]

TASK [output various check vars] ******************************************************************************************************************************************
ok: [34.83.126.81] => (item=check_uname_after_update) => {
    "ansible_loop_var": "item",
    "check_uname_after_update.stdout_lines": [
        "Linux ubu-1804-2 5.4.0-1036-gcp #39~18.04.1-Ubuntu SMP Sun Jan 17 11:08:21 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux"
    ],
    "item": "check_uname_after_update"
}
ok: [34.83.126.81] => (item=check_uptime_after_update) => {
    "ansible_loop_var": "item",
    "check_uptime_after_update.stdout_lines": [
        " 06:47:50 up 1 min,  1 user,  load average: 0.37, 0.12, 0.04"
    ],
    "item": "check_uptime_after_update"
}
ok: [34.83.126.81] => (item=check_lsbrelease) => {
    "ansible_loop_var": "item",
    "check_lsbrelease.stdout_lines": [
        "Distributor ID:\tUbuntu",
        "Description:\tUbuntu 18.04.5 LTS",
        "Release:\t18.04",
        "Codename:\tbionic"
    ],
    "item": "check_lsbrelease"
}

RUNNING HANDLER [pause in between] ****************************************************************************************************************************************
Pausing for 20 seconds
(ctrl+C then 'C' = continue early, ctrl+C then 'A' = abort)
ok: [34.83.126.81]

PLAY RECAP ****************************************************************************************************************************************************************
34.105.64.15               : ok=14   changed=5    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0
34.82.184.45               : ok=14   changed=4    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0
34.83.126.81               : ok=16   changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
35.203.155.182             : ok=16   changed=7    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

(base) [22:48]:[$USER@W-GPVW493|CentOS-7:update-os-ubuntu]$
